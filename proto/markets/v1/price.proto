syntax = "proto3";

package cqc.markets.v1;

option go_package = "github.com/Combine-Capital/cqc/gen/go/cqc/markets/v1;marketsv1";

import "google/protobuf/timestamp.proto";

// Price represents a point-in-time price observation for a trading symbol/market.
// Prices can come from various venues (exchanges, AMMs, oracles) and sources.
message Price {
  // Symbol identifier (UUID) for which this price is reported.
  // References the canonical symbol from the markets domain (e.g., BTC/USDT spot, ETH-PERP).
  optional string symbol_id = 1;

  // Numeric price value in the quote currency.
  // For symbols like BTC/USDT, this is the USDT price of 1 BTC.
  optional double value = 2;

  // Timestamp when this price was observed or generated.
  optional google.protobuf.Timestamp timestamp = 3;

  // Venue where this price was observed (e.g., "binance", "uniswap-v3-eth").
  // NULL for aggregated/oracle prices.
  optional string venue_id = 4;

  // Venue-specific symbol representation (e.g., "BTCUSDT" on Binance, "BTC-USD" on Coinbase).
  // NULL for oracle or aggregated prices.
  optional string venue_symbol = 5;

  // Data source for this price (e.g., "exchange_api", "chainlink_oracle", "internal_calc").
  optional string source = 6;

  // Volume traded at this price level (for trade prices).
  // NULL for non-trade price types.
  optional double volume = 7;

  // Bid price (highest buy order).
  // Only populated for bid-ask spread data.
  optional double bid = 8;

  // Ask price (lowest sell order).
  // Only populated for bid-ask spread data.
  optional double ask = 9;

  // Confidence or quality score for this price (0.0 to 1.0).
  // Higher values indicate more reliable prices.
  optional double confidence = 10;
}

// VWAP represents a Volume-Weighted Average Price over a time period.
// VWAP is calculated as the sum of (price * volume) divided by total volume.
message VWAP {
  // Symbol identifier (UUID) for which this VWAP is calculated.
  // References the canonical symbol from the markets domain.
  optional string symbol_id = 1;

  // Volume-weighted average price value.
  optional double value = 2;

  // Start timestamp of the VWAP calculation period.
  optional google.protobuf.Timestamp period_start = 3;

  // End timestamp of the VWAP calculation period.
  optional google.protobuf.Timestamp period_end = 4;

  // Total volume traded during the period (in base currency).
  optional double total_volume = 5;

  // Number of trades included in the calculation.
  optional int64 trade_count = 6;

  // Venue where trades occurred (NULL for cross-venue VWAP).
  optional string venue_id = 7;

  // Source of the VWAP calculation.
  optional string source = 8;

  // Standard deviation of prices during the period.
  optional double price_std_dev = 9;

  // Highest price during the period.
  optional double high = 10;

  // Lowest price during the period.
  optional double low = 11;
}
